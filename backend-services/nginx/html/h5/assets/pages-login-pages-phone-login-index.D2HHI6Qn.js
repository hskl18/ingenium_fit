var e=Object.defineProperty,r=Object.defineProperties,o=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(r,o,t)=>o in r?e(r,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[o]=t,n=(e,r)=>{for(var o in r||(r={}))a.call(r,o)&&s(e,o,r[o]);if(t)for(var o of t(r))l.call(r,o)&&s(e,o,r[o]);return e},c=(e,t)=>r(e,o(t)),p=(e,r,o)=>new Promise((t,a)=>{var l=e=>{try{n(o.next(e))}catch(r){a(r)}},s=e=>{try{n(o.throw(e))}catch(r){a(r)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(l,s);n((o=o.apply(e,r)).next())});import{d as u,u as i,b as d,r as m,c as f,i as x,w as h,a9 as b,N as _,C as g,f as v,_ as w,g as y,h as j,o as E,k as C,j as V,n as O,q as S,t as k,p as I,z as P,x as z,bV as M,bU as R,M as U,aw as N,bt as A,A as D,bZ as H,ab as T,I as G}from"./index-D9qffpGI.js";import{_ as L,a as W}from"./wd-tabs.CszGwLH7.js";import{_ as q}from"./26.BymsYty5.js";import{u as B,_ as F}from"./useGetMsgCode.DBuaUuCN.js";import{z as Z,p as J,v as Q}from"./index.CJVvTSkr.js";import{d as Y}from"./index.v6CH64ft.js";import{_ as $}from"./status-bar.vue_vue_type_script_setup_true_lang.DoCQBNOC.js";import{_ as K}from"./choose-area-code.vue_vue_type_script_setup_true_lang.Cb6rlvUN.js";import{w as X}from"./when.CilpbOlU.js";import{g as ee}from"./gt.BhFD8g82.js";import{l as re}from"./lte.BVKc29H8.js";import{e as oe}from"./equals.DY-30pRn.js";import{p as te}from"./pick.yfjiDSqe.js";import"./useTouch.3qBtZ6ci.js";import"./_curry2.BXt8VKw3.js";import"./keys.FBP1WlYN.js";import"./_nth.UVa0PGVR.js";import"./14.-y9J3EI9.js";import"./15.Bsjg2eDx.js";import"./useNetworkStatusChange.yjU6JEeW.js";import"./_curry3.VAFlxIU6.js";const ae=G(u({__name:"index",setup(e){const{t:r}=i(),o=d(),t=m(),{isSend:a,getMsgCode:l}=B(),s=m(0),u=m({areaCode:o.userArea.areaCode||"",phone:"",code:"",password:"",userPort:1}),G=Z.string().min(1,{message:r("common.input-placeholder.mobile-phone-number")}),ae=f(()=>{switch(s.value){case 0:return Z.object({phone:G,password:Z.string().min(1,{message:r("common.input-placeholder.password")})});case 1:return Z.object({phone:G,code:Z.string().min(1,{message:r("common.input-placeholder.verification-code")})})}});function le(){var e;null==(e=t.value)||e.init()}function se(e){u.value.areaCode=null==e?void 0:e.areaCode,u.value.phoneAreaCodeIcon=null==e?void 0:e.countryRegionIcon}const ne=X(function(){var e;const r=null==(e=ae.value)?void 0:e.safeParse(u.value);if(!r.success){const e=r.error.flatten().fieldErrors,o=J([0,0],Q(e));o&&b({title:o,icon:"none"})}return r.success},Y(g.debounceLongTime,function(){return p(this,null,function*(){try{const e=yield M(c(n({},u.value),{type:oe(+s.value,0)?R.PHONE_PASSWORD:R.PHONE_VERIFICATION_CODE}));yield b({title:r("pages-login.login-successfully"),icon:"none"}),o.token=e.data.token,yield U(()=>p(null,null,function*(){const e=yield o.getUserInfo();e.userRole?e.userRole!==N.INTERMEDIARY||e.whetherUploadIntermediaryExtraInfo?yield A({url:g.indexPath}):ce("/pages-login/pages/upload-material/index"):ce("/pages-login/pages/choose-identity/index")}))}catch(e){}})},{atBegin:!0}));function ce(e){D({url:e})}function pe(){(function(){const e=G.safeParse(u.value.phone);if(!e.success){const r=e.error.format();J(["_errors",0],r)&&b({title:J(["_errors",0],r),icon:"none"})}return e.success})()&&l(c(n({},te(["phone","areaCode"],u.value)),{type:H.PHONE_CODE_LOGIN}))}function ue(){T()}return(e,o)=>{const l=O,n=V,c=z,p=v(y("wd-input"),w),i=v(y("wd-tab"),L),d=v(y("wd-button"),j),m=v(y("wd-tabs"),W),f=_("layout-default-uni");return E(),x(f,null,{default:h(()=>[C(n,{class:"h-full"},{default:h(()=>[C($),C(n,{class:"",onClick:ue},{default:h(()=>[C(l,{class:"w-140rpx h-140rpx",src:q})]),_:1}),C(n,{class:"mt-38rpx px-32rpx"},{default:h(()=>[C(n,{class:"text-center text-48rpx text-#333 font-500"},{default:h(()=>[S(k(I(r)("pages-login.log-in-account")),1)]),_:1})]),_:1}),C(n,{class:"mt-118rpx px-32rpx pb-30rpx"},{default:h(()=>[C(n,{class:""},{default:h(()=>[C(m,{"slidable-num":0,lineWidth:31,lineHeight:2,inactiveColor:"#96959B",color:"#02989F",modelValue:I(s),"onUpdate:modelValue":o[4]||(o[4]=e=>P(s)?s.value=e:null)},{default:h(()=>[C(i,{title:I(r)("common.password")},{default:h(()=>[C(n,{class:"mt-86rpx"},{default:h(()=>[C(n,{class:"mb-20rpx text-28rpx text-#333333 font-500"},{default:h(()=>[S(k(I(r)("common.mobile-phone-number")),1)]),_:1}),C(n,{class:"flex space-x-8rpx"},{default:h(()=>[C(n,{class:"flex px-32rpx items-center space-x-34rpx h-90rpx border-custom !after:border-#E8E8E8 after:rounded-full",onClick:le},{default:h(()=>[C(c,{class:"text-28rpx text-#333"},{default:h(()=>[S(k(I(u).areaCode),1)]),_:1}),C(l,{class:"w-28rpx h-16rpx",src:F})]),_:1}),C(n,{class:"flex-1 flex px-28rpx items-center h-90rpx border-custom !after:border-#E8E8E8 after:rounded-full"},{default:h(()=>[C(p,{"no-border":"",clearable:"","focus-when-clear":!1,cursorSpacing:20,maxlength:20,modelValue:I(u).phone,"onUpdate:modelValue":o[0]||(o[0]=e=>I(u).phone=e),modelModifiers:{trim:!0},"custom-class":"relative z-1 flex-1 !bg-transparent","custom-input-class":"!h-90rpx",placeholderStyle:"font-size: 28rpx;color: #999;line-height: 40rpx;",placeholder:I(r)("common.input-placeholder.mobile-phone-number")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),C(n,{class:"mt-28rpx mb-20rpx text-28rpx text-#333333 font-500"},{default:h(()=>[S(k(I(r)("common.password")),1)]),_:1}),C(n,{class:"flex px-28rpx items-center h-90rpx border-custom !after:border-#E8E8E8 after:rounded-full"},{default:h(()=>[C(p,{"no-border":"",clearable:"","focus-when-clear":!1,cursorSpacing:20,maxlength:20,"show-password":"",modelValue:I(u).password,"onUpdate:modelValue":o[1]||(o[1]=e=>I(u).password=e),modelModifiers:{trim:!0},"custom-class":"relative z-1 flex-1 !bg-transparent","custom-input-class":"!h-90rpx",placeholderStyle:"font-size: 28rpx;color: #999;line-height: 40rpx;",placeholder:I(r)("common.input-placeholder.password")},null,8,["modelValue","placeholder"])]),_:1})]),_:1})]),_:1},8,["title"]),C(i,{title:I(r)("common.captcha")},{default:h(()=>[C(n,{class:"mt-86rpx"},{default:h(()=>[C(n,{class:"mb-20rpx text-28rpx text-#333333 font-500"},{default:h(()=>[S(k(I(r)("common.mobile-phone-number")),1)]),_:1}),C(n,{class:"flex space-x-8rpx"},{default:h(()=>[C(n,{class:"flex px-32rpx items-center space-x-34rpx h-90rpx border-custom !after:border-#E8E8E8 after:rounded-full",onClick:le},{default:h(()=>[C(c,{class:"text-28rpx text-#333"},{default:h(()=>[S(k(I(u).areaCode),1)]),_:1}),C(l,{class:"w-28rpx h-16rpx",src:F})]),_:1}),C(n,{class:"flex-1 flex px-28rpx items-center h-90rpx border-custom !after:border-#E8E8E8 after:rounded-full"},{default:h(()=>[C(p,{"no-border":"",clearable:"","focus-when-clear":!1,cursorSpacing:20,maxlength:20,modelValue:I(u).phone,"onUpdate:modelValue":o[2]||(o[2]=e=>I(u).phone=e),modelModifiers:{trim:!0},"custom-class":"relative z-1 flex-1 !bg-transparent","custom-input-class":"!h-90rpx",placeholderStyle:"font-size: 28rpx;color: #999;line-height: 40rpx;",placeholder:I(r)("common.input-placeholder.mobile-phone-number")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),C(n,{class:"mt-28rpx mb-20rpx text-28rpx text-#333333 font-500"},{default:h(()=>[S(k(I(r)("common.captcha")),1)]),_:1}),C(n,{class:"flex px-28rpx items-center h-90rpx border-custom !after:border-#E8E8E8 after:rounded-full"},{default:h(()=>[C(p,{"no-border":"",clearable:"","focus-when-clear":!1,cursorSpacing:20,maxlength:20,modelValue:I(u).code,"onUpdate:modelValue":o[3]||(o[3]=e=>I(u).code=e),modelModifiers:{trim:!0},"custom-class":"relative z-1 flex-1 !bg-transparent","custom-input-class":"!h-90rpx",placeholderStyle:"font-size: 28rpx;color: #999;line-height: 40rpx;",placeholder:I(r)("common.input-placeholder.verification-code")},null,8,["modelValue","placeholder"]),C(n,{class:"relative z-1 inline-flex center shrink-0 ml-20rpx"},{default:h(()=>[C(d,{type:"text",disabled:ee(I(a),0),"custom-class":"!text-26rpx",onClick:pe},{default:h(()=>[S(k(re(I(a),0)?I(r)("common.get-verification-code"):`${I(a)}S`),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),C(n,{class:"mt-152rpx"},{default:h(()=>[C(d,{"custom-class":"!h-90rpx !text-32rpx",block:"",onClick:I(ne)},{default:h(()=>[S(k(I(r)("common.confirm")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),C(K,{ref_key:"chooseAreaCodeRef",ref:t,onSuccess:se},null,512)]),_:1})]),_:1})}}}),[["__scopeId","data-v-315a7fa5"]]);export{ae as default};
