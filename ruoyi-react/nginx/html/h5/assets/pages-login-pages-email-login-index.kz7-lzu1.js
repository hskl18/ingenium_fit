var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(t,r,l)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[r]=l,n=(e,t)=>{for(var r in t||(t={}))a.call(t,r)&&s(e,r,t[r]);if(l)for(var r of l(t))o.call(t,r)&&s(e,r,t[r]);return e},c=(e,l)=>t(e,r(l)),i=(e,t,r)=>new Promise((l,a)=>{var o=e=>{try{n(r.next(e))}catch(t){a(t)}},s=e=>{try{n(r.throw(e))}catch(t){a(t)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,s);n((r=r.apply(e,t)).next())});import{d as p,u,b as m,r as d,c as f,i as x,w as h,a9 as b,N as g,C as _,f as w,_ as v,g as y,h as j,o as E,k as V,j as I,n as S,q as O,t as P,p as k,z as M,bV as z,bU as C,M as U,aw as A,bt as R,A as L,bX as D,ab as N,I as T}from"./index-D9qffpGI.js";import{_ as G,a as W}from"./wd-tabs.CszGwLH7.js";import{_ as q}from"./26.BymsYty5.js";import{z as B,p as F,v as H}from"./index.CJVvTSkr.js";import{d as J}from"./index.v6CH64ft.js";import{_ as K}from"./status-bar.vue_vue_type_script_setup_true_lang.DoCQBNOC.js";import{u as X}from"./useGetEmailMsgCode.unpV1CMg.js";import{w as Y}from"./when.CilpbOlU.js";import{g as $}from"./gt.BhFD8g82.js";import{l as Q}from"./lte.BVKc29H8.js";import{e as Z}from"./equals.DY-30pRn.js";import{p as ee}from"./pick.yfjiDSqe.js";import"./useTouch.3qBtZ6ci.js";import"./_curry2.BXt8VKw3.js";import"./keys.FBP1WlYN.js";import"./_nth.UVa0PGVR.js";import"./_curry3.VAFlxIU6.js";const te=T(p({__name:"index",setup(e){const{t:t}=u(),r=m(),{isSend:l,getMsgCode:a}=X(),o=d(0),s=d({email:"",code:"",password:"",userPort:1}),p=B.string().min(1,{message:t("common.input-placeholder.email")}).email({message:t("common.prompt.mailbox-number-incorrect")}),T=f(()=>{switch(o.value){case 0:return B.object({email:p,password:B.string().min(1,{message:t("common.input-placeholder.password")})});case 1:return B.object({email:p,code:B.string().min(1,{message:t("common.input-placeholder.verification-code")})})}});const te=Y(function(){var e,t;const r=null==(t=null==(e=T.value)?void 0:e.safeParse)?void 0:t.call(e,s.value);if(!r.success){const e=r.error.flatten().fieldErrors,t=F([0,0],H(e));t&&b({title:t,icon:"none"})}return r.success},J(_.debounceLongTime,function(){return i(this,null,function*(){try{const e=yield z(c(n({},s.value),{type:Z(+o.value,0)?C.EMAIL_PASSWORD:C.EMAIL_VERIFICATION_CODE}));yield b({title:t("pages-login.login-successfully"),icon:"none"}),r.token=e.data.token,yield U(()=>i(null,null,function*(){const e=yield r.getUserInfo();e.userRole?e.userRole!==A.INTERMEDIARY||e.whetherUploadIntermediaryExtraInfo?yield R({url:_.indexPath}):re("/pages-login/pages/upload-material/index"):re("/pages-login/pages/choose-identity/index")}))}catch(e){}})},{atBegin:!0}));function re(e){L({url:e})}function le(){(function(){const e=p.safeParse(s.value.email);if(!e.success){const t=e.error.format();F(["_errors",0],t)&&b({title:F(["_errors",0],t),icon:"none"})}return e.success})()&&a(c(n({},ee(["email"],s.value)),{type:D.EMAIL_LOGIN}))}function ae(){N()}return(e,r)=>{const a=S,n=I,c=w(y("wd-input"),v),i=w(y("wd-tab"),G),p=w(y("wd-button"),j),u=w(y("wd-tabs"),W),m=g("layout-default-uni");return E(),x(m,null,{default:h(()=>[V(n,null,{default:h(()=>[V(K),V(n,{class:"",onClick:ae},{default:h(()=>[V(a,{class:"w-140rpx h-140rpx",src:q})]),_:1}),V(n,{class:"mt-38rpx px-32rpx"},{default:h(()=>[V(n,{class:"text-center text-48rpx text-#333 font-500"},{default:h(()=>[O(P(k(t)("pages-login.log-in-account")),1)]),_:1})]),_:1}),V(n,{class:"mt-118rpx px-32rpx pb-30rpx"},{default:h(()=>[V(n,{class:""},{default:h(()=>[V(u,{"slidable-num":0,lineWidth:31,lineHeight:2,inactiveColor:"#96959B",color:"#02989F",modelValue:k(o),"onUpdate:modelValue":r[4]||(r[4]=e=>M(o)?o.value=e:null)},{default:h(()=>[V(i,{title:k(t)("common.password")},{default:h(()=>[V(n,{class:"mt-86rpx"},{default:h(()=>[V(n,{class:"mb-20rpx text-28rpx text-#333333 font-500"},{default:h(()=>[O(P(k(t)("common.email")),1)]),_:1}),V(n,{class:"flex px-28rpx items-center h-90rpx border-custom !after:border-#E8E8E8 after:rounded-full"},{default:h(()=>[V(c,{"no-border":"",clearable:"","focus-when-clear":!1,cursorSpacing:20,maxlength:255,modelValue:k(s).email,"onUpdate:modelValue":r[0]||(r[0]=e=>k(s).email=e),modelModifiers:{trim:!0},"custom-class":"relative z-1 flex-1 !bg-transparent","custom-input-class":"!h-90rpx",placeholderStyle:"font-size: 28rpx;color: #999;line-height: 40rpx;",placeholder:k(t)("common.input-placeholder.email")},null,8,["modelValue","placeholder"])]),_:1}),V(n,{class:"mt-28rpx mb-20rpx text-28rpx text-#333333 font-500"},{default:h(()=>[O(P(k(t)("common.password")),1)]),_:1}),V(n,{class:"flex px-28rpx items-center h-90rpx border-custom !after:border-#E8E8E8 after:rounded-full"},{default:h(()=>[V(c,{"no-border":"",clearable:"","focus-when-clear":!1,cursorSpacing:20,maxlength:20,"show-password":"",modelValue:k(s).password,"onUpdate:modelValue":r[1]||(r[1]=e=>k(s).password=e),modelModifiers:{trim:!0},"custom-class":"relative z-1 flex-1 !bg-transparent","custom-input-class":"!h-90rpx",placeholderStyle:"font-size: 28rpx;color: #999;line-height: 40rpx;",placeholder:k(t)("common.input-placeholder.password")},null,8,["modelValue","placeholder"])]),_:1})]),_:1})]),_:1},8,["title"]),V(i,{title:k(t)("common.captcha")},{default:h(()=>[V(n,{class:"mt-86rpx"},{default:h(()=>[V(n,{class:"mt-28rpx mb-20rpx text-28rpx text-#333333 font-500"},{default:h(()=>[O(P(k(t)("common.email")),1)]),_:1}),V(n,{class:"flex px-28rpx items-center h-90rpx border-custom !after:border-#E8E8E8 after:rounded-full"},{default:h(()=>[V(c,{"no-border":"",clearable:"","focus-when-clear":!1,cursorSpacing:20,maxlength:255,modelValue:k(s).email,"onUpdate:modelValue":r[2]||(r[2]=e=>k(s).email=e),modelModifiers:{trim:!0},"custom-class":"relative z-1 flex-1 !bg-transparent","custom-input-class":"!h-90rpx",placeholderStyle:"font-size: 28rpx;color: #999;line-height: 40rpx;",placeholder:k(t)("common.input-placeholder.new-password")},null,8,["modelValue","placeholder"])]),_:1}),V(n,{class:"mt-28rpx mb-20rpx text-28rpx text-#333333 font-500"},{default:h(()=>[O(P(k(t)("common.captcha")),1)]),_:1}),V(n,{class:"flex px-28rpx items-center h-90rpx border-custom !after:border-#E8E8E8 after:rounded-full"},{default:h(()=>[V(c,{"no-border":"",clearable:"","focus-when-clear":!1,cursorSpacing:20,maxlength:20,modelValue:k(s).code,"onUpdate:modelValue":r[3]||(r[3]=e=>k(s).code=e),modelModifiers:{trim:!0},"custom-class":"relative z-1 flex-1 !bg-transparent","custom-input-class":"!h-90rpx",placeholderStyle:"font-size: 28rpx;color: #999;line-height: 40rpx;",placeholder:k(t)("common.input-placeholder.verification-code")},null,8,["modelValue","placeholder"]),V(n,{class:"relative z-1 inline-flex center shrink-0 ml-20rpx"},{default:h(()=>[V(p,{type:"text",disabled:$(k(l),0),"custom-class":"!text-26rpx",onClick:le},{default:h(()=>[O(P(Q(k(l),0)?k(t)("common.get-verification-code"):`${k(l)}S`),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),V(n,{class:"mt-152rpx"},{default:h(()=>[V(p,{"custom-class":"!h-90rpx !text-32rpx",block:"",onClick:k(te)},{default:h(()=>[O(P(k(t)("common.confirm")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-d183f7e0"]]);export{te as default};
